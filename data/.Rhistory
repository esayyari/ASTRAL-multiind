d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V9 <- (d$V4+d$V7)/(d$V3+d$V6)
d$V9 <- (as.numeric(d$V4) + as.numeric(d$V7))/(as.numeric(d$V3) + as.numeric(d$V6))
head(d)
d$V3 <-as.numeric(d$V3)
d$V4 <-as.numeric(d$V4)
d$V5 <-as.numeric(d$V5)
d$V6 <-as.numeric(d$V6)
d$V7 <-as.numeric(d$V7)
d$V8 <-as.numeric(d$V8)
d$V9 <- (d$V4+d$V7)/(d$V3+d$V6)
head(d)
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V3
as.numeric(d$V3)
head(as.numeric(d$V3))
head(as.numeric(as.character(d$V3)))
d$V3<-as.numeric(as.character(d$V3))
is.Na(d$V3)
has.na(d$V3)
is.na(d$V3)
d$V3(is.na(d$V3))
unique(is.na(d$V3))
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
data[,3:8] <- as.numeric(as.character(data[,3:8]))
data[,c(3,4,5,6,7,8)] <- as.numeric(as.character(data[,c(3,4,5,6,7,8)]))
d[,c(3,4,5,6,7,8)] <- as.numeric(as.character(d[,c(3,4,5,6,7,8)]))
d
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V9 <- d$V3 + d$V6
d[, 3] <- as.numeric(as.character( d[, 3] ))
head(d$V3)
d[, 4] <- as.numeric(as.character( d[, 4] ))
d[, 5] <- as.numeric(as.character( d[, 5] ))
d[, 6] <- as.numeric(as.character( d[, 6] ))
d[, 7] <- as.numeric(as.character( d[, 7] ))
d[, 8] <- as.numeric(as.character( d[, 8] ))
d$V3
rlnorm(n=1000,mean=14.78,1)
qplot(rlnorm(n=1000,mean=14.78,1))
require(ggplot2)
qplot(rlnorm(n=1000,mean=14.78,1))
qplot(rlnorm(n=1000,mean=14.78,1),log='x')
qplot(rlnorm(n=1000,mean=14.7318,1),log='x')
summary(rlnorm(n=1000,mean=14.7318,1))
summary(rlnorm(n=1000,mean=15,1))
summary(rlnorm(n=1000,mean=16,1))
summary(rlnorm(n=1000,mean=16,1))
exp(16+0.5)
exp(15+0.5)
exp(15-0.5)
exp(15+0.5)
summary(rlnorm(n=1000,mean=16,1))
exp(16+0.5)
summary(rlnorm(n=10000,mean=16,1))
summary(rlnorm(n=10000,mean=1,1))
exp(14.78+0.5)
exp(14.7318+0.5)
exp(14.7318+0.5)
exp(14.7318+0.5)
log(5000000)-0.5
log(6000000)-0.5
log(8000000)-0.5
log(10000000)-0.5
exp(14.7318+0.5)
exp(14.7318-0.5)
exp(14.7318+0.5)
exp(14.7318-0.5)
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
require(ggplot2)
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
2*log(l)-1/8
log(450)*0.033
mean(rgamma(500000,scale=x,shape=log(l)*1/x))
exp(rgamma(500000,scale=x,shape=log(l)*1/x))
mean(exp(rgamma(500000,scale=x,shape=log(l)*1/x)))
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
log(l)*1/x
setwd('~/Documents/Research/myPapers/ASTRAL-multiind/data/branchLengths.csv')
setwd('~/Documents/Research/myPapers/ASTRAL-multiind/data/')
f<-read.csv('estimatedBrLengths.csv',sep=" ",header=F)
d <- read.csv('../data/seqLength.csv',header=F,sep=" ")
d$V2 <- as.numeric(as.character(d$V2))
h <- dcast(d, V1~.,value.var="V2",fun.aggregate=median)
require(reshape2)
require(ggplot2)
d <- read.csv('../data/seqLength.csv',header=F,sep=" ")
d$V2 <- as.numeric(as.character(d$V2))
h <- dcast(d, V1~.,value.var="V2",fun.aggregate=median)
names(h) <- c("V1","medianSeqLen")
print(h[h$medianSeqLen<300,1])
print(h[h$medianSeqLen>2000,1])
stat<-merge(x=h,y=q,by.x="V1",by.y="Replicate")
q<-read.csv('parameter.log.info',header=T,sep=" ")
print(h[h$medianSeqLen<300,1])
print(h[h$medianSeqLen>2000,1])
stat<-merge(x=h,y=q,by.x="V1",by.y="Replicate")
f<-read.csv('estimatedBrLengths.csv',sep=" ",header=F)
head(f)
head(q)
head(stat)
head(q)
names(q)
head(f)
head(q)
merge(f,q[,c(1,7)],by.x="V1",by.y="Haploid_efective_population_size")
q[,c(1,7)]
?merge
merge(f,q[,c(1,7)],all.x=T,all.y=T,
by.x="V1",by.y="Haploid_efective_population_size")
merge(f,q[,c(1,7)],by.x="V1",by.y="Haploid_efective_population_size",all=TRUE)
merge(f,q[,c(1,7)],by.x="V1",by.y="Replicate",all=TRUE)
br$true<-br$V2/br$Haploid_efective_population_size
br<-merge(f,q[,c(1,7)],by.x="V1",by.y="Replicate",all=TRUE)
br$true<-br$V2/br$Haploid_efective_population_size
head(br)
qplot(data=br,x=true,y=V3,log="xy",geom='jitter')
qplot(data=br[br$V3>0,],x=true,y=V3,log="xy",geom='jitter')
qplot(data=br[br$V3>0,],x=true,y=V3,log="xy",geom='jitter')+geom_smooth()
br$true<-br$V2/(2*br$Haploid_efective_population_size)
qplot(data=br[br$V3>0,],x=true,y=V3,log="xy",geom='jitter')+geom_smooth()
head(br)
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter')+geom_smooth()
br$true<-br$V2/(br$Haploid_efective_population_size)
br$logl <- abs(log10(as_bl[,7])-log10(as_bl[,9]))
head(br)
br$logl <- abs(log10(br[,5])-log10(br[,3]))
br$mrs <- (as_bl[,5]-as_bl[,3])^2
br$logl <- abs(log10(br[,5])-log10(br[,3]))
br$mrs <- (br[,5]-br[,3])^2
br$logl <- abs(log10(br[,5])-log10(br[,3]))
br$mrs <- (br[,5]-br[,3])^2
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter')+geom_smooth()
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter')+
geom_point(color=rgb(0,0,0,.2),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
ggsave('../figures/BL.pdf',width=8,height=6.2)
head(br)
?melt
melt(br
melt(br)
head(br)
recast(melt(br[,c(1,6,7)],id.vars ),
.~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
recast(melt(br[,c(1,6,7)],id.vars=c("V1") ),
.~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
melt(br[,c(1,6,7)],id.vars=c("V1") ),
+        .~variable,measure.var = "value",
+        fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),.~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)])
recast(melt(br[,c(1,6,7)],id.vars=c("V1") ),
.~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla=recast(melt(br[,c(1,6,7)],id.vars=c("V1") ),
.~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla
melt(br[,c(1,6,7)],id.vars=c("V1") ),
.~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),
~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
melt(br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)])
melt(data=br[,c(1,6,7)],id.vars=c("V1"))
melt(data=br[br$V3>0,c(1,6,7)],id.vars=c("V1"))
head(br)
melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1"))
recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla=recast(melt(data=br[br$V3>0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1"))
source('~/Documents/Research/myPapers/ASTRAL-multiind/R/removeRep.R')
bla=recast(melt(data=br[,c(1,6,7)],id.vars=c("V1") ),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
recast(
melt(br[,c(1,6,7)],id.vars=c("V1") ),
~variable,measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
head(br)
melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1"))
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla=recast(melt(br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
head(br)
f<-read.csv('estimatedBrLengths.csv',sep=" ",header=F)
br<-merge(f,q[,c(1,7)],by.x="V1",by.y="Replicate",all=TRUE)
br$true<-br$V2/(br$Haploid_efective_population_size)
br$logl <- abs(log10(br[,5])-log10(br[,3]))
br$mrs <- (br[,5]-br[,3])^2
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1"))
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],id.vars=c("V1")),.~variable,measure.var = "value",fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla
bla[,2:3]
bla[,2:3] = sqrt(bla[,2:3])
bla
bla[,2:3]
l=latex(format(bla,digits=2),file="bl.tex",rowname = NULL)
require(Hmisc)
install.packages('Hmisc')
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],
id.vars=c("V1")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla[,2:3] = sqrt(bla[,2:3])
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
require(Hmisc)
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
l
print(l)
log10(1/0.3)
br
head(br)
br$logl <- abs(log10(br[,3])-log10(br[,5]))
br$mrs <- (br[,5]-br[,3])^2
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter')+
geom_point(color=rgb(0,0,0,.2),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],
id.vars=c("V1")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla[,2:3] = sqrt(bla[,2:3])
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
bla
br$logl <- abs(log10(br[,3])-log10(br[,5]))
br$mrs <- (br[,5]-br[,3])^2
bla=recast(melt(data=br[br$V3!=0,c(1,6,7)],
id.vars=c("V1")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla[,2:3] = sqrt(bla[,2:3])
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
bla
