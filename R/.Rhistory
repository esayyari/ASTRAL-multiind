d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V9 <- (d$V4+d$V7)/(d$V3+d$V6)
d$V9 <- (as.numeric(d$V4) + as.numeric(d$V7))/(as.numeric(d$V3) + as.numeric(d$V6))
head(d)
d$V3 <-as.numeric(d$V3)
d$V4 <-as.numeric(d$V4)
d$V5 <-as.numeric(d$V5)
d$V6 <-as.numeric(d$V6)
d$V7 <-as.numeric(d$V7)
d$V8 <-as.numeric(d$V8)
d$V9 <- (d$V4+d$V7)/(d$V3+d$V6)
head(d)
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V3
as.numeric(d$V3)
head(as.numeric(d$V3))
head(as.numeric(as.character(d$V3)))
d$V3<-as.numeric(as.character(d$V3))
is.Na(d$V3)
has.na(d$V3)
is.na(d$V3)
d$V3(is.na(d$V3))
unique(is.na(d$V3))
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
data[,3:8] <- as.numeric(as.character(data[,3:8]))
data[,c(3,4,5,6,7,8)] <- as.numeric(as.character(data[,c(3,4,5,6,7,8)]))
d[,c(3,4,5,6,7,8)] <- as.numeric(as.character(d[,c(3,4,5,6,7,8)]))
d
d<-read.csv('~/Desktop/results/error_rate_gtr_jc.csv',sep=" ",header=F)
head(d)
d$V9 <- d$V3 + d$V6
d[, 3] <- as.numeric(as.character( d[, 3] ))
head(d$V3)
d[, 4] <- as.numeric(as.character( d[, 4] ))
d[, 5] <- as.numeric(as.character( d[, 5] ))
d[, 6] <- as.numeric(as.character( d[, 6] ))
d[, 7] <- as.numeric(as.character( d[, 7] ))
d[, 8] <- as.numeric(as.character( d[, 8] ))
d$V3
rlnorm(n=1000,mean=14.78,1)
qplot(rlnorm(n=1000,mean=14.78,1))
require(ggplot2)
qplot(rlnorm(n=1000,mean=14.78,1))
qplot(rlnorm(n=1000,mean=14.78,1),log='x')
qplot(rlnorm(n=1000,mean=14.7318,1),log='x')
summary(rlnorm(n=1000,mean=14.7318,1))
summary(rlnorm(n=1000,mean=15,1))
summary(rlnorm(n=1000,mean=16,1))
summary(rlnorm(n=1000,mean=16,1))
exp(16+0.5)
exp(15+0.5)
exp(15-0.5)
exp(15+0.5)
summary(rlnorm(n=1000,mean=16,1))
exp(16+0.5)
summary(rlnorm(n=10000,mean=16,1))
summary(rlnorm(n=10000,mean=1,1))
exp(14.78+0.5)
exp(14.7318+0.5)
exp(14.7318+0.5)
exp(14.7318+0.5)
log(5000000)-0.5
log(6000000)-0.5
log(8000000)-0.5
log(10000000)-0.5
exp(14.7318+0.5)
exp(14.7318-0.5)
exp(14.7318+0.5)
exp(14.7318-0.5)
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
require(ggplot2)
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
2*log(l)-1/8
log(450)*0.033
mean(rgamma(500000,scale=x,shape=log(l)*1/x))
exp(rgamma(500000,scale=x,shape=log(l)*1/x))
mean(exp(rgamma(500000,scale=x,shape=log(l)*1/x)))
x=0.033;l=450;qplot(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100); summary(exp(2*log(l)-1/8-rgamma(500000,scale=x,shape=log(l)*1/x)+(runif(500000,0.3,0.7)^2)/2),binwidth=100)
log(l)*1/x
setwd('~/Documents/Research/myPapers/ASTRAL-multiind/R')
require(reshape2)
require(ggplot2)
require(Hmisc)
d <- read.csv('../data/seqLength.csv',header=F,sep=" ")
d$V2 <- as.numeric(as.character(d$V2))
h <- dcast(d, V1~.,value.var="V2",fun.aggregate=median)
names(h) <- c("V1","medianSeqLen")
q<-read.csv('parameter.log.info',header=T,sep=" ")
q<-read.csv('../data/parameter.log.info',header=T,sep=" ")
print(h[h$medianSeqLen<300,1])
print(h[h$medianSeqLen>2000,1])
stat<-merge(x=h,y=q,by.x="V1",by.y="Replicate")
f<-read.csv('estimatedBrLengths.csv',sep=" ",header=F)
f<-read.csv('../data/estimatedBrLengths.csv',sep=" ",header=F)
br<-merge(f,q[,c(1,7)],by.x="V1",by.y="Replicate",all=TRUE)
br$true<-br$V2/(br$Haploid_efective_population_size)
br$logl <- abs(log10(br[,3])-log10(br[,5]))
br$mrs <- (br[,5]-br[,3])^2
head(br)
head(f)
head(h)
br<-merge(f,q,by.x="V1",by.y="Replicate",all=TRUE)
head(br)
br$true<-br$V2/(br$Haploid_efective_population_size)
head(br)
ncol(br)
br$logl <- abs(log10(br[,3])-log10(br[,14]))
br$mrs <- (br[,14]-br[,3])^2
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter',color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.2),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter',color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),geom='jitter',color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(color=rgb(0,0,0,.1),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
?ggplot
(data=br[br$V3>0,])+
geom_point(aes(x=log10(true),y=log10(V3),color=Number_of_Genes),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
(data=br[br$V3>0,])+
geom_point(aes(x=log10(br$true),y=log10(br$V3),color=br$Number_of_Genes),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
(data=br[br$V3>0,],x=log10(true),y=log10(V3),color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
(data=br[br$V3>0,],x=log10(true),y=log10(V3),color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
qplot(data=br[br$V3>0,],x=log10(true),y=log10(V3),color=Number_of_Genes)+
geom_point(color=rgb(0,0,0,.1),size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.3,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_colour_brewer()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_brewer()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous()
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(low='red')
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(low='green')
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(low="red", high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(low="blue", high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( high="white")
ggsave('../figures/BL.pdf',width=8,height=6.2)
head(br)
ncol(br)
bla=recast(melt(data=br[br$V3!=0,c(1,15,16)],
id.vars=c("V1")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla
bla[,2:3] = sqrt(bla[,2:3])
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
bla
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=1,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggsave('../figures/BL-alpha1.pdf',width=8,height=6.2)
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggsave('../figures/BL-alpha0.5.pdf',width=8,height=6.2)
max(br$Numbr_of_Genes)
sort(br$Numbr_of_Genes)
sort(br$Number_of_Genes)
max(br$Number_of_Genes)
br[br$Number_of_Genes>666,]$labelG <- "High NumGenes"
br[br$Number_of_Genes>666,]$labelG
br[br$Number_of_Genes>666,]
br[br$Number_of_Genes>666,]$h <- 1
(br[br$Number_of_Genes>666,])$h <- 1
br$labelG <- "H"
br[br$Number_of_Genes>666,]$labelG <- "High NumGenes"
br[br$Number_of_Genes<=666 & br$Number_of_Genes>333,]$labelG <-"Med NumGenes"
br[br$Number_of_Genes<=333,]$labelG <- "Low NumGenes"
head(br)
gplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~.labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~.labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(.~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous( low='red',high="white")
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(high="white")
br$labelG <- factor(br$labelG, levels = c("High NumGenes", "Med NumGenes", "Low NumGenes"))
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(high="white")
bla=recast(melt(data=br[br$V3!=0,c(1,15,16)],
id.vars=c("V1")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla[,2:3] = sqrt(bla[,2:3])
l=latex(format(bla,digits=3),file="../figures/bl.tex",rowname = NULL)
ggplot(data=br[br$V3>0,],aes(x=log10(true),y=log10(V3),color=Number_of_Genes))+facet_wrap(~labelG)+
geom_point(alpha=0.5,size=1.5)+theme_bw()+
theme(legend.position="bottom")+
xlab("true branch length (log scale)")+
geom_abline(linetype=2)+ ylab("Estimated branch length (log scale)")+
coord_cartesian(ylim=c(-5.3,2.3),xlim=c(-5.3,2.3))+geom_smooth()+scale_color_continuous(high="white")
ggsave('../figures/BL-diffLevelsNumGenes.pdf',width=8,height=6.2)
bla=recast(melt(data=br[br$V3!=0,c(1,15,16,17)],
id.vars=c("V1","labelG")),.~variable,
measure.var = "value",
fun.aggregate=function(x)mean(x[!is.infinite(x)]))
bla
melt(data=br[br$V3!=0,c(1,15,16,17)],
id.vars=c("V1","labelG"))
